<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yuchen.mapper.IconMapper">
    <insert id="insertIcon">
        insert into t_iot_icon(industry_id,icon_status,icon_byte)
            value(#{industryId},#{iconStatus},#{in})
    </insert>

    <select id="getIconStream" parameterType="string" resultType="object">
        select icon_byte from t_iot_icon
        where id = #{id}
    </select>

    <insert id="insertIcons" parameterType="list">
        insert into t_iot_icon(industry_id,icon_address,upload_status,icon_status,icon_byte,icon_type)
        values
         <foreach collection="list" separator="," index="index" item="item">
             (#{item.industryId},null,0,#{item.iconStatus},null,#{item.iconType})
         </foreach>
    </insert>

    <update id="insertIconFile">
        update t_iot_icon
        set icon_byte = #{inputStream}
        where industry_id = #{industryId}
        and icon_status = #{iconStatus}
        and icon_type = 0
    </update>

    <select id="getAll" resultType="map">
        select id id,icon_byte iconByte
        FROM t_iot_icon
        where upload_status = 1
        and icon_byte is not null
    </select>

    <insert id="testInsert" parameterType="list">
        INSERT INTO t_iot_device VALUES
        <foreach collection="list" index="index" item="item" separator=",">
            (#{item.id}, NULL, #{item.product_id}, 1, #{item.device_name}, 0, 1, '蜂窝移动网(2G /3G/ 4G /5G)', 1, 'z96MN9amSC7kaK73sZMtiC8offlJ7jo9', 1, NULL, NULL, NULL, 'yuchen', '2023-09-22 16:32:02', '2023-09-22 16:32:02', NULL, NULL, 0, 49)
        </foreach>
    </insert>

    <select id="select" resultType="map">
        select id,product_id,device_name
        from t_iot_device
        where id = #{id}
    </select>
</mapper>